@use "../../../abstracts/abstracts" as *;

// ==========================================================================
// Block Group
// Card-like container for grouped blocks (news items, announcements, etc.)
// ==========================================================================

// Block groups containing HTML blocks (text content cards)
// Excludes: page title blocks, blocks with assets (handled separately)
// Includes: blocks with line breaks (spacing elements are fine)
.block-blockGroup:has(.block-html):not(:has(.block-asset)):not(:has(.block-pageTitle)) {
    // Text content blocks get card styling with visual interest
    position: relative;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    margin-block-end: var(--space-lg);

    // Subtle inner glow for depth
    &::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: var(--radius-lg);
        box-shadow: inset 0 1px 0 0 color-mix(in srgb, white 8%, transparent);
        pointer-events: none;
    }

    // Hover effect for interactivity
    transition: transform var(--transition-base),
    box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-sm));
        box-shadow: var(--shadow-xl), var(--glow-sm);
    }
}

// News-style block groups (contain asset + html blocks)
// Target block groups that have .block-asset as a direct child
.block-blockGroup {

    // When block group contains an asset and text (news item pattern)
    &:has(.block-asset) {
        background: var(--panel-bg);
        border: var(--panel-border);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-md), var(--glow-xs);
        padding: var(--space-lg);
        margin-block-end: var(--space-lg);
        transition:
            transform var(--transition-base),
            box-shadow var(--transition-base),
            border-color var(--transition-base);

        &:hover {
            transform: translateY(var(--lift-sm));
            box-shadow: var(--shadow-xl), var(--glow-sm);
            border-color: color-mix(in srgb, var(--primary) 30%, var(--border));
        }

        // Reset child block margins inside card
        .block {
            margin-block-end: 0;
        }

        // Style the asset image inside the card
        .block-asset {
            margin-block-end: 0;

            .asset {
                border-radius: var(--radius-md);
                overflow: hidden;

                img {
                    width: 100%;
                    height: auto;
                    display: block;
                    transition: transform var(--transition-slow);
                }
            }
        }

        // Image zoom on card hover
        &:hover .asset img {
            transform: scale(1.03);
        }

        // Text content styling
        .block-html {
            h3 {
                margin-block-start: 0;
                color: var(--ink);
                font-size: var(--text-lg);
            }

            p {
                color: var(--ink-light);
                margin-block-end: 0;

                &:last-child {
                    margin-block-end: 0;
                }
            }
        }
    }

    // Block groups that are just containers (no special styling)
    &.block-group-grid:not(:has(.block-asset)) {
        // Pure grid container - inherits default styles
        display: grid;
    }
}

// Standalone asset blocks (not in a block group with text)
.block-asset:not(.block-blockGroup .block-asset) {
    .asset {
        background: var(--panel-bg);
        border: var(--panel-border);
        border-radius: var(--radius-lg);
        box-shadow: var(--panel-shadow);
        overflow: hidden;
        transition:
            transform var(--transition-base),
            box-shadow var(--transition-base);

        &:hover {
            transform: translateY(var(--lift-xxs));
            box-shadow: var(--shadow-md);
        }

        img {
            width: 100%;
            height: auto;
            display: block;
        }
    }
}

// Date headers for news sections
.block-html h3:first-child {
    &:only-child {
        // Likely a date header
        color: var(--primary);
        font-size: var(--text-base);
        font-weight: 600;
        margin-block: var(--space-sm) var(--space-xs);
    }
}

// ==========================================================================
// Enhanced Content Block Styling
// Rich typography and visual interest for main content areas
// ==========================================================================

// Standalone HTML blocks (not inside block groups) - main content cards
.block-html:not(.block-blockGroup .block-html) {
    position: relative;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    margin-block-end: var(--space-lg);

    // Hover effect
    transition:
        transform var(--transition-base),
        box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-sm));
        box-shadow: var(--shadow-xl), var(--glow-sm);
    }
}

// Content blocks - enhanced readability for both standalone and grouped
.block-blockGroup .block-html,
.block-html {

    // Ensure first element has no top margin to avoid double spacing with padding
    > :first-child {
        margin-block-start: 0;
    }

    // Lead paragraph styling (first paragraph gets subtle emphasis)
    // Use base size to avoid inconsistent scaling on desktop
    >p:first-of-type {
        font-size: var(--text-base);
        line-height: 1.75;
        color: var(--ink);

        // Slightly larger on wider screens where there's more room
        @media (min-width: $lg) {
            font-size: clamp(var(--text-base), 1rem + 0.1vw, var(--text-lg));
        }
    }

    // Standard paragraphs - consistent sizing
    p {
        font-size: var(--text-base);
        line-height: 1.75;

        // Links get enhanced styling in content
        a {
            font-weight: 500;
            text-decoration-thickness: 0.09em;
            text-underline-offset: 0.2em;

            &:hover {
                text-decoration-thickness: 0.12em;
            }
        }
    }

    // Italic text styling (for titles, emphasis)
    em,
    i {
        color: var(--ink);
        font-style: italic;
    }
}