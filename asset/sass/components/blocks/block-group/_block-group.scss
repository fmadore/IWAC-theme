@use "../../../abstracts/abstracts" as *;

// ==========================================================================
// Block Group
// Card-like container for grouped blocks (news items, announcements, etc.)
// ==========================================================================

// Block groups containing HTML blocks (text content cards)
// Excludes: page title blocks, blocks with assets (handled separately)
// Includes: blocks with line breaks (spacing elements are fine)
.block-blockGroup:has(.block-html):not(:has(.block-asset)):not(:has(.block-pageTitle)):not(.block-group-grid) {
    // Text content blocks get card styling with visual interest
    position: relative;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    margin-block-end: var(--space-lg);

    // Subtle inner glow for depth
    &::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: var(--radius-lg);
        box-shadow: inset 0 1px 0 0 color-mix(in srgb, white 8%, transparent);
        pointer-events: none;
    }

    // Hover effect for interactivity
    transition: transform var(--transition-base),
    box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-xs));
        box-shadow: var(--shadow-xl), var(--glow-sm);
    }
}

// Cards inside grids - equal height with flex layout
.block-group-grid > .block-blockGroup:has(.block-html):not(:has(.block-asset)) {
    position: relative;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    height: 100%;
    display: flex;
    flex-direction: column;

    // Subtle inner glow for depth
    &::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: var(--radius-lg);
        box-shadow: inset 0 1px 0 0 color-mix(in srgb, white 8%, transparent);
        pointer-events: none;
    }

    // Hover effect
    transition: transform var(--transition-base),
    box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-xs));
        box-shadow: var(--shadow-xl), var(--glow-sm);
    }

    // Content inside card
    .block-html {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
}

// ==========================================================================
// Block groups with assets only (no text) - gallery style
// ==========================================================================
.block-blockGroup:has(.block-asset):not(:has(.block-html)) {
    margin-block-end: var(--space-lg);
}

// ==========================================================================
// Block groups with both assets AND text - news card style
// ==========================================================================
.block-blockGroup:has(.block-asset):has(.block-html) {
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    margin-block-end: var(--space-lg);
    transition:
        transform var(--transition-base),
        box-shadow var(--transition-base),
        border-color var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-xs));
        box-shadow: var(--shadow-xl), var(--glow-sm);
        border-color: color-mix(in srgb, var(--primary) 30%, var(--border));
    }

    // Reset child block margins inside card
    .block {
        margin-block-end: var(--space-4);

        &:last-child {
            margin-block-end: 0;
        }
    }

    // Text content styling
    .block-html {
        h3 {
            margin-block-start: 0;
            color: var(--ink);
            font-size: var(--text-lg);
        }
    }
}

// ==========================================================================
// Grid layout for block groups (team members, cards, etc.)
// ==========================================================================
.block-blockGroup.block-group-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 300px), 1fr));
    gap: var(--space-6);
    align-items: stretch;

    // Remove margin from direct children - gap handles spacing
    > .block {
        margin-block-end: 0;
    }

    // Cards inside grid stretch to equal height
    > .block-blockGroup,
    > .block-html {
        height: 100%;
        display: flex;
        flex-direction: column;

        // Push last element to bottom for consistent card layout
        > :last-child {
            margin-block-start: auto;
        }
    }
}

// ==========================================================================
// Asset styling - applies to all .assets containers
// ==========================================================================
.assets {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 280px), 1fr));
    gap: var(--space-6);
    justify-items: center;

    // When only 2 items, limit width so they don't stretch too wide
    &:has(.asset:nth-child(2):last-child) {
        max-width: 700px;
        margin-inline: auto;
    }

    // Single asset - center and constrain
    &:has(.asset:only-child) {
        justify-content: center;
    }
}

.asset {
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--panel-shadow);
    overflow: hidden;
    width: 100%;
    max-width: 320px;
    transition:
        transform var(--transition-base),
        box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-xxs));
        box-shadow: var(--shadow-md);
    }

    img {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
        aspect-ratio: 4 / 3;
    }

    // Caption styling
    .caption {
        padding: var(--space-3) var(--space-4);
        font-size: var(--text-sm);
        color: var(--muted);
        text-align: center;
        background: var(--surface-raised);
        border-top: 1px solid var(--border-light);
    }
}

// Date headers for news sections
.block-html h3:first-child {
    &:only-child {
        // Likely a date header
        color: var(--primary);
        font-size: var(--text-base);
        font-weight: 600;
        margin-block: var(--space-sm) var(--space-xs);
    }
}

// ==========================================================================
// Enhanced Content Block Styling
// Rich typography and visual interest for main content areas
// ==========================================================================

// Standalone HTML blocks (not inside block groups) - main content cards
.block-html:not(.block-blockGroup .block-html) {
    position: relative;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md), var(--glow-xs);
    padding: var(--space-lg);
    margin-block-end: var(--space-lg);

    // Hover effect
    transition:
        transform var(--transition-base),
        box-shadow var(--transition-base);

    &:hover {
        transform: translateY(var(--lift-xs));
        box-shadow: var(--shadow-xl), var(--glow-sm);
    }
}

// Content blocks - enhanced readability for both standalone and grouped
.block-blockGroup .block-html,
.block-html {

    // Ensure first element has no top margin to avoid double spacing with padding
    > :first-child {
        margin-block-start: 0;
    }

    // Lead paragraph styling (first paragraph gets subtle emphasis)
    // Use base size to avoid inconsistent scaling on desktop
    >p:first-of-type {
        font-size: var(--text-base);
        line-height: var(--line-height-relaxed);
        color: var(--ink);

        // Slightly larger on wider screens where there's more room
        @media (min-width: $lg) {
            font-size: clamp(var(--text-base), 1rem + 0.1vw, var(--text-lg));
        }
    }

    // Standard paragraphs - consistent sizing
    p {
        font-size: var(--text-base);
        line-height: var(--line-height-relaxed);

        // Links get enhanced styling in content
        a {
            font-weight: 500;
            text-decoration-thickness: 0.09em;
            text-underline-offset: 0.2em;

            &:hover {
                text-decoration-thickness: 0.12em;
            }
        }
    }

    // Italic text styling (for titles, emphasis)
    em,
    i {
        color: var(--ink);
        font-style: italic;
    }
}